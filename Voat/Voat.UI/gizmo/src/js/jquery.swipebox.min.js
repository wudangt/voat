/*! Swipebox v1.4.1 | Constantin Saguin csag.co | MIT License | github.com/brutaldesign/swipebox */
(function(n,t,i,r){i.swipebox=function(u,f){var s,w={useCSS:!0,useSVG:!0,initialIndexOnArray:0,removeBarsOnMobile:!1,hideCloseButtonOnMobile:!1,hideBarsDelay:0,videoMaxWidth:1140,vimeoColor:"cccccc",beforeOpen:null,afterOpen:null,afterClose:null,nextSlide:null,prevSlide:null,loopAtEnd:!1,autoplayVideos:!1,queryStringData:{},toggleClassOnLoad:""},e=this,o=[],c,l=u.selector,b=i(l),v=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(Android)|(PlayBook)|(BB10)|(BlackBerry)|(Opera Mini)|(IEMobile)|(webOS)|(MeeGo)/i),y=v!==null||t.createTouch!==r||"ontouchstart"in n||"onmsgesturechange"in n||navigator.msMaxTouchPoints,k=!!t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,a=n.innerWidth?n.innerWidth:i(n).width(),p=n.innerHeight?n.innerHeight:i(n).height(),h=0,d='<div id="swipebox-overlay">\t\t\t\t\t<div id="swipebox-container">\t\t\t\t\t\t<div id="swipebox-slider"><\/div>\t\t\t\t\t\t<div id="swipebox-top-bar">\t\t\t\t\t\t\t<div id="swipebox-title"><\/div>\t\t\t\t\t\t<\/div>\t\t\t\t\t\t<div id="swipebox-bottom-bar">\t\t\t\t\t\t\t<div id="swipebox-arrows">\t\t\t\t\t\t\t\t<a id="swipebox-prev"><\/a>\t\t\t\t\t\t\t\t<a id="swipebox-next"><\/a>\t\t\t\t\t\t\t<\/div>\t\t\t\t\t\t<\/div>\t\t\t\t\t\t<a id="swipebox-close"><\/a>\t\t\t\t\t<\/div>\t\t\t<\/div>';e.settings={};i.swipebox.close=function(){s.closeSlide()};i.swipebox.extend=function(){return s};e.init=function(){if(e.settings=i.extend({},w,f),i.isArray(u))o=u,s.target=i(n),s.init(e.settings.initialIndexOnArray);else i(t).on("click",l,function(n){if(n.target.parentNode.className==="slide current")return!1;i.isArray(u)||(s.destroy(),c=i(l),s.actions());o=[];var f,r,t;t||(r="data-rel",t=i(this).attr(r));t||(r="rel",t=i(this).attr(r));c=t&&t!==""&&t!=="nofollow"?b.filter("["+r+'="'+t+'"]'):i(l);c.each(function(){var n=null,t=null;i(this).attr("title")&&(n=i(this).attr("title"));i(this).attr("href")&&(t=i(this).attr("href"));o.push({href:t,title:n})});f=c.index(i(this));n.preventDefault();n.stopPropagation();s.target=i(n.target);s.init(f)})};s={init:function(n){e.settings.beforeOpen&&e.settings.beforeOpen();this.target.trigger("swipebox-start");i.swipebox.isOpen=!0;this.build();this.openSlide(n);this.openMedia(n);this.preloadMedia(n+1);this.preloadMedia(n-1);e.settings.afterOpen&&e.settings.afterOpen()},build:function(){var n=this,t;i("body").append(d);k&&e.settings.useSVG===!0&&(t=i("#swipebox-close").css("background-image"),t=t.replace("png","svg"),i("#swipebox-prev, #swipebox-next, #swipebox-close").css({"background-image":t}));v&&e.settings.removeBarsOnMobile&&i("#swipebox-bottom-bar, #swipebox-top-bar").remove();i.each(o,function(){i("#swipebox-slider").append('<div class="slide"><\/div>')});n.setDim();n.actions();y&&n.gesture();n.keyboard();n.animBars();n.resize()},setDim:function(){var t,r,u={};"onorientationchange"in n?n.addEventListener("orientationchange",function(){n.orientation===0?(t=a,r=p):(n.orientation===90||n.orientation===-90)&&(t=p,r=a)},!1):(t=n.innerWidth?n.innerWidth:i(n).width(),r=n.innerHeight?n.innerHeight:i(n).height());u={width:t,height:r};i("#swipebox-overlay").css(u)},resize:function(){var t=this;i(n).resize(function(){t.setDim()}).resize()},supportTransition:function(){for(var i="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" "),n=0;n<i.length;n++)if(t.createElement("div").style[i[n]]!==r)return i[n];return!1},doCssTrans:function(){if(e.settings.useCSS&&this.supportTransition())return!0},gesture:function(){var r=this,v,n,t,y,w,f,l=!1,e=!1,p=10,b=50,s={},c={},k=i("#swipebox-top-bar, #swipebox-bottom-bar"),u=i("#swipebox-slider");k.addClass("visible-bars");r.setTimeout();i("body").bind("touchstart",function(r){return i(this).addClass("touching"),v=i("#swipebox-slider .slide").index(i("#swipebox-slider .slide.current")),c=r.originalEvent.targetTouches[0],s.pageX=r.originalEvent.targetTouches[0].pageX,s.pageY=r.originalEvent.targetTouches[0].pageY,i("#swipebox-slider").css({"-webkit-transform":"translate3d("+h+"%, 0, 0)",transform:"translate3d("+h+"%, 0, 0)"}),i(".touching").bind("touchmove",function(r){if(r.preventDefault(),r.stopPropagation(),c=r.originalEvent.targetTouches[0],!e&&(w=t,t=c.pageY-s.pageY,Math.abs(t)>=b||l)){var k=.75-Math.abs(t)/u.height();u.css({top:t+"px"});u.css({opacity:k});l=!0}y=n;n=c.pageX-s.pageX;f=n*100/a;!e&&!l&&Math.abs(n)>=p&&(i("#swipebox-slider").css({"-webkit-transition":"",transition:""}),e=!0);e&&(0<n?0===v?i("#swipebox-overlay").addClass("leftSpringTouch"):(i("#swipebox-overlay").removeClass("leftSpringTouch").removeClass("rightSpringTouch"),i("#swipebox-slider").css({"-webkit-transform":"translate3d("+(h+f)+"%, 0, 0)",transform:"translate3d("+(h+f)+"%, 0, 0)"})):0>n&&(o.length===v+1?i("#swipebox-overlay").addClass("rightSpringTouch"):(i("#swipebox-overlay").removeClass("leftSpringTouch").removeClass("rightSpringTouch"),i("#swipebox-slider").css({"-webkit-transform":"translate3d("+(h+f)+"%, 0, 0)",transform:"translate3d("+(h+f)+"%, 0, 0)"}))))}),!1}).bind("touchend",function(o){if(o.preventDefault(),o.stopPropagation(),i("#swipebox-slider").css({"-webkit-transition":"-webkit-transform 0.4s ease",transition:"transform 0.4s ease"}),t=c.pageY-s.pageY,n=c.pageX-s.pageX,f=n*100/a,l)if(l=!1,Math.abs(t)>=2*b&&Math.abs(t)>Math.abs(w)){var v=t>0?u.height():-u.height();u.animate({top:v+"px",opacity:0},300,function(){r.closeSlide()})}else u.animate({top:0,opacity:1},300);else e?(e=!1,n>=p&&n>=y?r.getPrev():n<=-p&&n<=y&&r.getNext()):k.hasClass("visible-bars")?r.clearTimeout():(r.showBars(),r.setTimeout());i("#swipebox-slider").css({"-webkit-transform":"translate3d("+h+"%, 0, 0)",transform:"translate3d("+h+"%, 0, 0)"});i("#swipebox-overlay").removeClass("leftSpringTouch").removeClass("rightSpringTouch");i(".touching").off("touchmove").removeClass("touching")})},setTimeout:function(){if(e.settings.hideBarsDelay>0){var t=this;t.clearTimeout();t.timeout=n.setTimeout(function(){},e.settings.hideBarsDelay)}},clearTimeout:function(){n.clearTimeout(this.timeout);this.timeout=null},showBars:function(){var n=i("#swipebox-top-bar, #swipebox-bottom-bar");this.doCssTrans()?n.addClass("visible-bars"):(i("#swipebox-top-bar").animate({top:0},500),i("#swipebox-bottom-bar").animate({bottom:0},500),setTimeout(function(){n.addClass("visible-bars")},1e3))},hideBars:function(){},animBars:function(){var n=this,t=i("#swipebox-top-bar, #swipebox-bottom-bar");t.addClass("visible-bars");n.setTimeout();i("#swipebox-slider").click(function(){t.hasClass("visible-bars")||(n.showBars(),n.setTimeout())});i("#swipebox-bottom-bar").hover(function(){n.showBars();t.addClass("visible-bars");n.clearTimeout()},function(){e.settings.hideBarsDelay>0&&(t.removeClass("visible-bars"),n.setTimeout())})},keyboard:function(){var t=this;i(n).bind("keyup",function(n){n.preventDefault();n.stopPropagation();n.keyCode===37?t.getPrev():n.keyCode===39?t.getNext():n.keyCode===27&&t.closeSlide()})},actions:function(){var n=this,t="touchend click";o.length<2?(i("#swipebox-bottom-bar").hide(),r===o[1]&&i("#swipebox-top-bar").hide()):(i("#swipebox-prev").bind(t,function(t){t.preventDefault();t.stopPropagation();n.getPrev();n.setTimeout()}),i("#swipebox-next").bind(t,function(t){t.preventDefault();t.stopPropagation();n.getNext();n.setTimeout()}));i("#swipebox-close").bind(t,function(){})},setSlide:function(n,t){t=t||!1;var r=i("#swipebox-slider");h=-n*100;this.doCssTrans()?r.css({"-webkit-transform":"translate3d("+-n*100+"%, 0, 0)",transform:"translate3d("+-n*100+"%, 0, 0)"}):r.animate({left:-n*100+"%"});i("#swipebox-slider .slide").removeClass("current");i("#swipebox-slider .slide").eq(n).addClass("current");this.setTitle(n);t&&r.fadeIn();i("#swipebox-prev, #swipebox-next").removeClass("disabled");n===0?i("#swipebox-prev").addClass("disabled"):n===o.length-1&&e.settings.loopAtEnd!==!0&&i("#swipebox-next").addClass("disabled")},openSlide:function(t){i("html").addClass("swipebox-html");y?(i("html").addClass("swipebox-touch"),e.settings.hideCloseButtonOnMobile&&i("html").addClass("swipebox-no-close-button")):i("html").addClass("swipebox-no-touch");i(n).trigger("resize");this.setSlide(t,!0)},preloadMedia:function(n){var t=this,i=null;o[n]!==r&&(i=o[n].href);t.isVideo(i)?t.openMedia(n):setTimeout(function(){t.openMedia(n)},1e3)},openMedia:function(n){var f=this,u,t;if(o[n]!==r&&(u=o[n].href),n<0||n>=o.length)return!1;t=i("#swipebox-slider .slide").eq(n);f.isVideo(u)?t.html(f.getVideo(u)):(t.addClass("slide-loading"),f.loadMedia(u,function(){t.removeClass("slide-loading");t.html(this)}))},setTitle:function(n){var t=null,u=null;i("#swipebox-title").empty();o[n]!==r&&(t=o[n].title,u="/v/"+o[n].subverse+"/comments/"+o[n].submissionid,upvotes=o[n].upvotes,thingy='<a href="'+u+'" target="_blank">'+t+"<\/a> (+"+upvotes+")");t?(i("#swipebox-top-bar").show(),i("#swipebox-title").append(thingy)):i("#swipebox-top-bar").hide()},isVideo:function(n){if(n&&(n.match(/(youtube\.com|youtube-nocookie\.com)\/watch\?v=([a-zA-Z0-9\-_]+)/)||n.match(/vimeo\.com\/([0-9]*)/)||n.match(/youtu\.be\/([a-zA-Z0-9\-_]+)/)||n.toLowerCase().indexOf("swipeboxvideo=1")>=0))return!0},parseUri:function(n,r){var f=t.createElement("a"),u={};return f.href=decodeURIComponent(n),f.search&&(u=JSON.parse('{"'+f.search.toLowerCase().replace("?","").replace(/&/g,'","').replace(/=/g,'":"')+'"}')),i.isPlainObject(r)&&(u=i.extend(u,r,e.settings.queryStringData)),i.map(u,function(n,t){if(n&&n>"")return encodeURIComponent(t)+"="+encodeURIComponent(n)}).join("&")},getVideo:function(n){var t="",i=n.match(/((?:www\.)?youtube\.com|(?:www\.)?youtube-nocookie\.com)\/watch\?v=([a-zA-Z0-9\-_]+)/),u=n.match(/(?:www\.)?youtu\.be\/([a-zA-Z0-9\-_]+)/),f=n.match(/(?:www\.)?vimeo\.com\/([0-9]*)/),r="";return i||u?(u&&(i=u),r=s.parseUri(n,{autoplay:e.settings.autoplayVideos?"1":"0",v:""}),t='<iframe width="560" height="315" src="//'+i[1]+"/embed/"+i[2]+"?"+r+'" frameborder="0" allowfullscreen><\/iframe>'):f?(r=s.parseUri(n,{autoplay:e.settings.autoplayVideos?"1":"0",byline:"0",portrait:"0",color:e.settings.vimeoColor}),t='<iframe width="560" height="315"  src="//player.vimeo.com/video/'+f[1]+"?"+r+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen><\/iframe>'):t='<iframe width="560" height="315" src="'+n+'" frameborder="0" allowfullscreen><\/iframe>','<div class="swipebox-video-container" style="max-width:'+e.settings.videoMaxWidth+'px"><div class="swipebox-video">'+t+"<\/div><\/div>"},loadMedia:function(n,t){if(n.trim().indexOf("#")===0)t.call(i("<div>",{"class":"swipebox-inline-container"}).append(i(n).clone().toggleClass(e.settings.toggleClassOnLoad)));else if(!this.isVideo(n)){var r=i("<img>").on("load",function(){t.call(r)});r.attr("src",n)}},getNext:function(){var t=this,r,n=i("#swipebox-slider .slide").index(i("#swipebox-slider .slide.current"));n+1<o.length?(r=i("#swipebox-slider .slide").eq(n).contents().find("iframe").attr("src"),i("#swipebox-slider .slide").eq(n).contents().find("iframe").attr("src",r),n++,t.setSlide(n),t.preloadMedia(n+1),e.settings.nextSlide&&e.settings.nextSlide()):e.settings.loopAtEnd===!0?(r=i("#swipebox-slider .slide").eq(n).contents().find("iframe").attr("src"),i("#swipebox-slider .slide").eq(n).contents().find("iframe").attr("src",r),n=0,t.preloadMedia(n),t.setSlide(n),t.preloadMedia(n+1),e.settings.nextSlide&&e.settings.nextSlide()):(i("#swipebox-overlay").addClass("rightSpring"),setTimeout(function(){i("#swipebox-overlay").removeClass("rightSpring")},500))},getPrev:function(){var n=i("#swipebox-slider .slide").index(i("#swipebox-slider .slide.current")),t;n>0?(t=i("#swipebox-slider .slide").eq(n).contents().find("iframe").attr("src"),i("#swipebox-slider .slide").eq(n).contents().find("iframe").attr("src",t),n--,this.setSlide(n),this.preloadMedia(n-1),e.settings.prevSlide&&e.settings.prevSlide()):(i("#swipebox-overlay").addClass("leftSpring"),setTimeout(function(){i("#swipebox-overlay").removeClass("leftSpring")},500))},nextSlide:function(){},prevSlide:function(){},closeSlide:function(){i("html").removeClass("swipebox-html");i("html").removeClass("swipebox-touch");i(n).trigger("resize");this.destroy()},destroy:function(){i(n).unbind("keyup");i("body").unbind("touchstart");i("body").unbind("touchmove");i("body").unbind("touchend");i("#swipebox-slider").unbind();i("#swipebox-overlay").remove();i.isArray(u)||u.removeData("_swipebox");this.target&&this.target.trigger("swipebox-destroy");i.swipebox.isOpen=!1;e.settings.afterClose&&e.settings.afterClose()}};e.init()};i.fn.swipebox=function(n){if(!i.data(this,"_swipebox")){var t=new i.swipebox(this,n);this.data("_swipebox",t)}return this.data("_swipebox")}})(window,document,jQuery);
//# sourceMappingURL=jquery.swipebox.min.js.map
